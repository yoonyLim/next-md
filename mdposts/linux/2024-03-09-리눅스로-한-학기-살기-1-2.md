---
title: "리눅스로 한 학기 살기 1주차"
subtitle: "리눅스 Distro 선택 및 설치-2"
date: "2024-03-09"
---

# [리눅스] 리눅스로 한 학기 살기 - 1주차: 리눅스 Distro 선택 및 설치-2

이전 [포스트]()에서 계속된다.

## 3. 리눅스 Distro 설치

### 3.1 MacOS에서 UTM 가상머신을 통한 설치

아래의 단계를 통해 MacOS에서 UTM 가상머신을 통해 Debian GNU/Linux 설치 방법을 다룬다.
참고로 UTM은 무료 오픈소스 소프트웨어이다. UTM은 QEMU 시스템 에뮬레이터를 사용하여 격리된 가상환경을 제공한다.

1. Debian GNU/Linux 이미지 파일을 공식 사이트에서 다운로드한다. 이때 본인 컴퓨터 CPU 아키텍처에 맞는 이미지 파일을 다운로드해야 한다. 본은은 M2 애플 실리콘 칩의 맥북 에어를 사용하므로 arm64 버전을 다운로드했다. 애플 실리콘 등의 arm64 계열이면 [이 사이트 주소](https://cdimage.debian.org/debian-cd/current/arm64/iso-cd/)에서 이미지 파일을 다운로드하면 되고 intel 칩 등의 amd64 계열이면 [이 사이트 주소](https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/)에서 이미지 파일을 다운로드하면 된다. 이 외로도 Debian GNU/Linux는 다양한 CPU 아키텍처에 대해 이미지 파일을 제공하고 있다.
![img0](/images/linux/20240309/img0.png)


2. [UTM 공식 사이트](https://mac.getutm.app/)에서 UTM 가상머신 설치 파일을 다운로드하고 설치한다. (프로젝트를 지원하는 마음으로 애플 앱스토어에서 구매할 수도 있다.)
![img1](/images/linux/20240309/img1.png)

3. UTM 프로그램을 실행시키고 중앙 4개의 선택지 중 "Create a New Virtual Machine"을 선택한다. 이후 방식으로는 "Virtualize", 운영체제로는 "Linux"를 선택한다. (참고로 본인은 학교 수업 중 Windows용 Visual Studio를 이용해야 하는 과목이 있기에 Windows 11을 UTM에 설치했다. 본인도 Windows 11을 굳이 깔고 싶진 않았다...)

| | | |
| :--- | :---: | ---: |
| ![img2-1](/images/linux/20240309/img2-1.png) | ![img2-2](/images/linux/20240309/img2-2.png) | ![img2-3](/images/linux/20240309/img2-3.png) |

4. 단계 1에서 설치한 Debian GNU/Linux 이미지 파일 경로를 입력한다. 이후 차례대로 할당할 메모리, 스토리지, 원한다면 MacOS와 공유할 디렉토리를 설정한다.

| | | | |
| :--- | :---: | ---: |
| ![img3-1](/images/linux/20240309/img3-1.png) | ![img3-2](/images/linux/20240309/img3-2.png) | ![img3-3](/images/linux/20240309/img3-3.png) | ![img3-4](/images/linux/20240309/img3-4.png) |

5. 설정을 최종 확인하고 UTM에 추가된 Debian GNU/Linux의 셋업을 시작한다.

| | |
| :--- | ---: |
| ![img4-1](/images/linux/20240309/img4-1.png) | ![img4-2](/images/linux/20240309/img4-2.png) |

6. 지역(국가), locale(언어), 키보드 레이아웃, hostname(네트워크 상 표시될 이름), domain name(.com과 같은 도메인 이름), 루트 비밀번호, 사용자, 파티션, 패키지 매니저 등을 설정한다.

| | | |
| :--- | :---: | ---: |
| ![img5-1](/images/linux/20240309/img5-1.png) | ... | ![img5-2](/images/linux/20240309/img5-2.png) |

7. 이후 Debian GNU/Linux 초기 설치 단계가 아닌 이미 셋업한 운영체제를 사용하기 위해 아래 사진 표시된 부분을 CD/DVD로 바꿔준다.

![img6](/images/linux/20240309/img6.png)

8. 마지막으로 Debian GNU/Linux를 부팅하면 설정한 대로 부팅되는 모습을 볼 수 있다.

![img7](/images/linux/20240309/img7.png)

### 3.2 파티션을 통한 듀얼부팅 설치

#### 3.2.1 SSD 파티션

듀얼부팅을 위해서는 우선 리눅스 운영체제가 깔릴 공간을 마련해야 한다. 이때 Windows 11을 쓰던 HDD(~~아직도 데스크탑용으로 HDD를 쓴다면...~~) 혹 SSD에서 파티션을 진행하는 도중 "You cannot shrink a volume beyond the point where any unmovable files are located."라는 경고 문구가 나오며 "defrag"를 진행하라는 경고가 나온다. 해당 문구의 이유는 Windows 11을 쓰다 보면 SSD의 임의의 공간에 hibernation file, paging file 등 Windows 11의 Disk Manager가 옮길 수 없는 파일들이 생성되기 때문이다. 이때 해당 데이터를 SSD의 한 공간으로 "몰아넣는" 작업이 필요하다.<br>
파티션 단계는 아래와 같이 진행했다.

1. Disk Management에 들어가려면 윈도우즈 검색창에 검색해도 되고 윈도우즈 버튼을 우클릭 후 "Disk Management"를 클릭해도 된다. 그리고 아래 우측처럼 Disk Management를 열게 되면 파티션하고자 하는 스토리지를 선택하면 된다. 본인은 NVME SSD 1TB 2개를 사용 중인데 하나는 위도우즈 메인용, 다른 하나는 게임 저장용이다. 본인은 게임 저장용으로 쓰던 D: 드라이브를 파티션하겠다.

| | |
| :--- | ---: |
| ![img8-1](/images/linux/20240309/img8-1.png) | ![img4-2](/images/linux/20240309/img8-2.png) |

2. 파티션하고자 하는 드라이브를 우클릭하여 "Shrink"를 클릭한다. 그러면 아래와 같이 분할할 수 있는 공간이 표시되는데 본인은 976,746 MB 중 26,705 MB를 최대로 새로운 파티션 생성이 가능하다고 표시된다. 그러나 이상한 점은 아래 사진에서 분명 해당 SSD의 여유 공간은 701.26 GB라고 뜨지만 대략 26 GB의 파티션만 생성 가능하다는 의미이다. 해당 이유는 위에서 설명한 것처럼 SSD 중간중간 임의 공간에 Disk Manager로는 옮길 수 없는 파일들이 존재하기 때문이다.

![img9](/images/linux/20240309/img9.png)

3. Defragment를 진행한다. Defragment는 원래 메모리 장치에 특정 목적 섹션들을 생성하여 최적화하는 방법이다. SSD의 경우는 별 효과가 없으며 오히려 defragment 진행 시 write cycle을 소모하기 때문에 오히려 SSD 수명에 악영향을 미칠 수 있다(물론 한두번 가지고 막대한 영향은 없지만...). 그래도 파티션을 위해 진행하자면, 윈도우즈 검색창에 "Defragment and Optimize Drivers"을 검색하여 해당 드라이브를 "Optimize"하거나 직접 관리자 터미널에서 "defrag [드라이버 이름] /L" 명령을 입력하여 진행할 수 있다. 하지만 본인은 이 단계 이후에도 최대 파티션 공간이 변하지 않았다.

| | |
| :--- | ---: |
| ![img10-1](/images/linux/20240309/img10-1.png) | ![img10-2](/images/linux/20240309/img10-2.png) |

4. Hibernation을 해제한다. 윈도우즈의 hibernation 모드는 컴퓨터가 재부팅되었을 때에도 빠른 세션 복구를 위해 드라이브에 마지막 세션에 대한 데이터를 저장하는 모드이다. 해당 모드로 "hiberfil.sys"라는 파일이 시스템 드라이브에 생성되며 이는 Disk Manager가 옮길 수 없는 파일 형태 중 하나이다. 해당 모드 해제는 간단한데, 관리자 terminal에서 "powercfg.exe -h off"를 입력하면 해당 모드가 해제되며 "hiberfil.sys" 파일이 삭제된다. 하지만 본인은 이 단계 이후에도 최대 파티션 공간이 변하지 않았다.

![img11](/images/linux/20240309/img11.png)

5. Paging file을 삭제한다. Paging file이란 윈도우즈가 드라이브의 일부 공간을 RAM처럼 사용하기 위해 생성된 숨겨진 시스템 파일이다. 따라서 해당 파일은 삭제해도 RAM의 크기가 충분하다면 윈도우즈가 돌아가기에 막대한 영향을 미치지는 않는다.(물론 본인은 32 GB 듀얼 RAM을 사용하기에 과감히 삭제했다.) 이는 Disk Manager가 옮길 수 없는 파일 형태 중 하나이기도 하다. 해당 파일을 삭제하기 위해서 윈도우즈 검색창에 "View advanced system settings"를 검색하여 뜨는 창에서 "Advanced" 탭의 "Performance" 섹션의 "Settings..."를 클릭한다. 다음에 뜨는 창에서 "Advanced" 탭에서 "Virtual memory" 섹션의 'Change...'를 클릭한다. 그리고 뜨는 창에서 파티션할 드라이브를 선택 후 라디오 버튼 중 "No paging file"로 바꾸고 "Set"을 클릭한 다음 컴퓨터 재부팅을 하면 paging file이 삭제되며 해당 드라이브에서는 더 이상 paging file이 만들어지지 않는다. 하지만 본인은 이 단계 이후에도 최대 파티션 공간이 변하지 않았다.

| | | |
| :--- | :---: | ---: |
| ![img12-1](/images/linux/20240309/img12-1.png) | ![img12-2](/images/linux/20240309/img12-2.png) | ![img11-3](/images/linux/20240309/img12-3.png) |

6. System Protection을 해제한다. 시스템 보호 설정이 켜져 있으면 Disk Manager가 옮길 수 없는 파일이 생성된다고 한다. 단계 5처럼 "View advanced system settings"에 들어가 "System Protection" 탭에 들어간 후 해제하고자 하는 드라이브를 선택한 뒤 "Configure..."을 클릭한다. 그리고 뜨는 창에서 라디오 버튼 중 "Disable system protection"을 선택한 다음 적용 후 컴퓨터를 재부팅하면 된다. 하지만 본인은 이 단계 이후에도 최대 파티션 공간이 변하지 않았다.

| | |
| :--- | ---: |
| ![img14-1](/images/linux/20240309/img14-1.png) | ![img14-2](/images/linux/20240309/img14-2.png) |

결국 마지막 수단으로 3자 제공 소프트웨어를 사용한다. 파티션을 위해 다양한 도구들이 존재하지만 본인은 GParted(GNOME Partition Editor)라는 리눅스 계열 오픈소스 소프트웨어를 사용하기로 했다. 해당 소프트웨어는 Debian GNU/Linux 계열의 소프트웨어로 이미지 파일로 제공되기에 부팅할 USB 혹시 CD 등의 매개체가 필요하다. 어차피 듀얼부팅을 위해 리눅스 이미지 파일을 쓰기 위해 부팅 USB가 필요하던 참이라 바로 부팅 USB를 만들도록 한다.

7. Rufus를 공식 [사이트](https://rufus.ie/en/)에서 다운로드한다. 해당 소프트웨어는 윈도우즈 전용 소프트웨어이므로 다운로드 사이트에서 CPU 아키텍처만 잘 맞는 exe 파일을 다운받고 설치하면 된다.

| | |
| :--- | ---: |
| ![img15-1](/images/linux/20240309/img15-1.png) | ![img15-2](/images/linux/20240309/img15-2.png) |

8. GParted를 공식 [사이트](https://gparted.org/download.php)에서 다운로드한다. 위와 마찬가지로 CPU 아키텍처가 맞는 이미지 파일을 다운받는다. 본인은 인텔 칩이니 amd64 버전을 다운로드했다. 그리고 해당 이미지 파일을 부팅할 USB를 컴퓨터에 인식시키고 Rufus를 실행하여 인식한 USB에서 GParted의 이미지 파일 경로를 선택한 뒤 "Start"를 눌러 부팅 USB로 만든다.

| | |
| :--- | ---: |
| ![img16-1](/images/linux/20240309/img16-1.png) | ![img16-2](/images/linux/20240309/img16-2.png) |

9. 컴퓨팅을 재부팅하여 BIOS 부팅 메뉴로 들어가야 한다. 본인은 컴퓨터는 MSI 마더보드이기에 해당 BIOS에 진입하기 위해 재부팅 시 "F11"을 연타했다. 해당 BIOS에서 부팅 USB를 선택하여 부팅 후 키보드 레이아웃을 "Don't touch keymap", keymap을 기본의 "[33]"으로 선택한 뒤 GParted의 GUI 화면으로 들어갔다. 해당 화면에서 파티션할 드라이브를 선택 후 원하는만큼 여유 공간 중 파티션을 배정했다. 본인은 256 GB를 배정했다. 그리고 마지막으로 상단 메뉴바의 "Apply All Operations"를 클릭하고 컴퓨터를 재부팅하면 된다. 드디어 성공적으로 길고 긴 파티션 과정이 끝났다.

| | |
| :--- | ---: |
| ![img17-1](/images/linux/20240309/img17-1.png) | ![img17-2](/images/linux/20240309/img17-2.png) |

### 3.3 Windows 11에서 WSL2를 통한 설치